import{At as e,Cn as t,Ct as n,Dt as r,Et as i,F as a,Gt as o,Jt as s,Kt as c,Mt as l,Nt as ee,On as u,Ot as d,S as te,Tn as f,Wt as ne,Xt as re,a as ie,d as p,f as m,hn as h,in as g,jt as _,kt as v,m as ae,n as oe,p as y,rt as b,u as se}from"./game-logic-CfBcTF_c.js";import"./vendor-pinia-DP9x75p8.js";import{a as ce,o as le}from"./vendor-vue-router-CWDMmE-U.js";import"./vendor-crypto-Ce_BCn-h.js";import"./game-i18n-DEf7ySVe.js";import"./vendor-others-CUjrprN5.js";import"./vendor-reka-ui-CZQh7FLl.js";import"./vendor-utils-Dg-HLkEU.js";import"./vendor-vueuse-C7EbLx--.js";import{I as ue,S as de,_ as fe,c as pe,d as me,r as he,v as ge}from"./vendor-icons-W6Ny__75.js";import{t as x}from"./CardDescription-D2AN1hhX.js";import{f as S,m as C,u as _e}from"./game-config-D-D7cMgJ.js";import{A as w,F as ve,I as ye,M as T,O as E,P as be,c as D,i as O,k as xe,l as k,r as A,s as j,t as M,u as N,w as P}from"./index-DWmvUlvu.js";import{t as Se}from"./useGameConfig-B5wf1i8i.js";import{t as Ce}from"./AlertDialog-CiXBEnQ0.js";import{t as we}from"./UnlockRequirement-c2kDZKZ0.js";var Te={key:0,class:`container mx-auto p-4 sm:p-6 space-y-4 sm:space-y-6`},Ee={class:`text-2xl sm:text-3xl font-bold`},De={class:`flex gap-2 border-b`},Oe={key:0},ke={class:`grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4`},Ae={class:`flex justify-between items-start`},je={class:`font-semibold text-sm sm:text-base`},Me={class:`text-xl sm:text-2xl font-bold`},Ne={class:`text-xs sm:text-sm text-muted-foreground space-y-1`},Pe={key:1,class:`space-y-4`},Fe={class:`flex justify-between items-center`},Ie={class:`text-sm font-medium`},Le={class:`text-sm font-bold`},Re={class:`grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4`},ze={class:`flex gap-2`},Be={class:`grid grid-cols-3 gap-2 sm:gap-4`},Ve={class:`space-y-2`},He={class:`space-y-2`},Ue={class:`space-y-2`},We={class:`grid grid-cols-2 sm:grid-cols-3 gap-2`},Ge={class:`grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4`},Ke={class:`space-y-2`},qe={class:`space-y-2`},Je={class:`space-y-2`},Ye={class:`text-xs sm:text-sm text-muted-foreground mt-2`},Xe={class:`flex justify-between text-xs sm:text-sm`},Ze={class:`text-muted-foreground`},Qe={class:`flex items-center gap-1.5`},F={class:`text-muted-foreground`},$e={key:0,class:`flex justify-between text-xs sm:text-sm`},et={class:`text-muted-foreground`},tt={key:2,class:`space-y-4`},nt={class:`flex justify-between items-start`},rt={class:`text-xs sm:text-sm font-medium mb-2`},it={class:`flex flex-wrap gap-2`},at={key:0},ot={class:`text-xs sm:text-sm font-medium mb-2`},st={class:`flex flex-wrap gap-2 text-xs`},ct={key:0,class:`flex items-center gap-1`},lt={key:1,class:`flex items-center gap-1`},ut={key:2,class:`flex items-center gap-1`},dt={key:3,class:`flex items-center gap-1`},ft={class:`space-y-2`},pt={class:`flex justify-between text-xs sm:text-sm`},mt={class:`flex gap-2`},I=ee({__name:`FleetView`,setup(ee){let I=ce(),ht=le(),L=ye(),gt=ve(),{t:R}=be(),{SHIPS:z}=Se(),B=i(()=>L.currentPlanet),V=h(null),H=h(Date.now()),U=null,_t=i(()=>a(b(L.player.officers,Date.now()).additionalFleetSlots)),W=h(`fleet`),G=h({[C.LightFighter]:0,[C.HeavyFighter]:0,[C.Cruiser]:0,[C.Battleship]:0,[C.SmallCargo]:0,[C.LargeCargo]:0,[C.ColonyShip]:0,[C.Recycler]:0,[C.EspionageProbe]:0,[C.DarkMatterHarvester]:0,[C.Deathstar]:0}),K=h({galaxy:1,system:1,position:1}),q=h(S.Attack),J=h({metal:0,crystal:0,deuterium:0,darkMatter:0,energy:0});ne(()=>{U=window.setInterval(()=>{H.value=Date.now()},1e3);let{galaxy:e,system:t,position:n,mission:r}=I.query;(e||t||n)&&(e&&(K.value.galaxy=Number(e)),t&&(K.value.system=Number(t)),n&&(K.value.position=Number(n)),r===`spy`?q.value=S.Spy:r===`attack`?q.value=S.Attack:r===`colonize`&&(q.value=S.Colonize),W.value=`send`,ht.replace({path:`/fleet`}))}),o(()=>{U&&clearInterval(U)});let Y=i(()=>[{type:S.Attack,name:R(`fleetView.attackMission`),icon:pe},{type:S.Transport,name:R(`fleetView.transport`),icon:de},{type:S.Colonize,name:R(`fleetView.colonize`),icon:fe},{type:S.Spy,name:R(`fleetView.spy`),icon:ue},{type:S.Deploy,name:R(`fleetView.deploy`),icon:he},{type:S.Recycle,name:R(`fleetView.recycle`),icon:ge},{type:S.Destroy,name:R(`fleetView.destroy`),icon:me}]),vt=e=>Y.value.find(t=>t.type===e)?.name||e,yt=e=>L.player.planets.find(t=>t.id===e)?.name||R(`fleetView.unknownPlanet`),X=()=>{let e=0;for(let[t,n]of Object.entries(G.value))if(n>0){let r=z.value[t];e+=r.cargoCapacity*n}return e},Z=()=>J.value.metal+J.value.crystal+J.value.deuterium+J.value.darkMatter,Q=()=>{let e=b(L.player.officers,Date.now());return se(G.value,e.fuelConsumptionReduction,J.value)},bt=()=>{if(!B.value)return 0;let e=m(B.value.position,K.value),t=b(L.player.officers,Date.now());return y(e,p(G.value,t.fleetSpeedBonus))},$=()=>{if(!Object.values(G.value).some(e=>e>0))return{valid:!1,errorKey:`fleetView.noShipsSelected`};if(B.value&&K.value.galaxy===B.value.position.galaxy&&K.value.system===B.value.position.system&&K.value.position===B.value.position.position)return{valid:!1,errorKey:`fleetView.cannotSendToOwnPlanet`};if(q.value===S.Transport&&Z()>X())return{valid:!1,errorKey:`fleetView.cargoExceedsCapacity`};if(q.value===S.Colonize&&(!G.value[C.ColonyShip]||(G.value[C.ColonyShip]??0)<1))return{valid:!1,errorKey:`fleetView.noColonyShip`};if(q.value===S.Recycle){let e=`debris_${K.value.galaxy}_${K.value.system}_${K.value.position}`,t=gt.debrisFields[e];if(!t||t.resources.metal===0&&t.resources.crystal===0)return{valid:!1,errorKey:`fleetView.noDebrisAtTarget`}}return q.value===S.Destroy&&(!G.value[C.Deathstar]||(G.value[C.Deathstar]??0)<1)?{valid:!1,errorKey:`fleetView.noDeathstar`}:{valid:!0}},xt=(e,t,n,r={metal:0,crystal:0,deuterium:0,darkMatter:0,energy:0})=>{if(!L.currentPlanet)return!1;let i=L.player.fleetMissions.length,a=ie(L.currentPlanet,n,r,L.player.officers,i);if(!a.valid)return!1;let o=t===S.Transport;oe(L.currentPlanet,n,a.fuelNeeded,o,r);let s=y(m(L.currentPlanet.position,e),p(n,b(L.player.officers,Date.now()).fleetSpeedBonus)),c=ae(L.player.id,L.currentPlanet.id,e,t,n,r,s);return L.player.fleetMissions.push(c),!0},St=()=>{if(!B.value)return;let e=$();if(!e.valid){V.value?.show({title:R(`fleetView.sendFailed`),message:e.errorKey?R(e.errorKey):R(`fleetView.sendFailedMessage`)});return}let t={};for(let[e,n]of Object.entries(G.value))n>0&&(t[e]=n);xt(K.value,q.value,t,q.value===S.Transport?J.value:void 0)?(Object.keys(G.value).forEach(e=>{G.value[e]=0}),J.value={metal:0,crystal:0,deuterium:0,darkMatter:0,energy:0},W.value=`missions`):V.value?.show({title:R(`fleetView.sendFailed`),message:R(`fleetView.sendFailedMessage`)})},Ct=e=>{let t=L.player.fleetMissions.find(t=>t.id===e);return t?te(t,Date.now()):!1},wt=e=>{Ct(e)||V.value?.show({title:R(`fleetView.recallFailed`),message:R(`fleetView.recallFailedMessage`)})},Tt=e=>{let t=H.value,n=e.status===`outbound`?e.arrivalTime:e.returnTime;return Math.max(0,(n-t)/1e3)},Et=e=>{let t=H.value;if(e.status===`outbound`){let n=e.arrivalTime-e.departureTime,r=t-e.departureTime;return Math.max(0,Math.min(100,r/n*100))}else{let n=e.arrivalTime,r=e.returnTime-n,i=t-n;return Math.max(0,Math.min(100,i/r*100))}};return(i,a)=>B.value?(c(),e(`div`,Te,[l(we,{"required-building":t(_e).Shipyard,"required-level":1},null,8,[`required-building`]),r(`h1`,Ee,u(t(R)(`fleetView.title`)),1),r(`div`,De,[l(t(T),{onClick:a[0]||=e=>W.value=`fleet`,variant:W.value===`fleet`?`default`:`ghost`,class:`rounded-b-none`},{default:g(()=>[_(u(t(R)(`fleetView.fleetOverview`)),1)]),_:1},8,[`variant`]),l(t(T),{onClick:a[1]||=e=>W.value=`send`,variant:W.value===`send`?`default`:`ghost`,class:`rounded-b-none`},{default:g(()=>[_(u(t(R)(`fleetView.sendFleet`)),1)]),_:1},8,[`variant`]),l(t(T),{onClick:a[2]||=e=>W.value=`missions`,variant:W.value===`missions`?`default`:`ghost`,class:`rounded-b-none`},{default:g(()=>[_(u(t(R)(`fleetView.flightMissions`))+` `,1),t(L).player.fleetMissions.length>0?(c(),d(t(w),{key:0,variant:`secondary`,class:`ml-1`},{default:g(()=>[_(u(t(L).player.fleetMissions.length),1)]),_:1})):v(``,!0)]),_:1},8,[`variant`])]),W.value===`fleet`?(c(),e(`div`,Oe,[l(t(N),null,{default:g(()=>[l(t(D),null,{default:g(()=>[l(t(j),null,{default:g(()=>[_(u(t(R)(`fleetView.currentPlanetFleet`)),1)]),_:1}),l(t(x),null,{default:g(()=>[_(u(B.value.name)+` [`+u(B.value.position.galaxy)+`:`+u(B.value.position.system)+`:`+u(B.value.position.position)+`] `,1)]),_:1})]),_:1}),l(t(k),null,{default:g(()=>[r(`div`,ke,[(c(!0),e(n,null,s(B.value.fleet,(n,i)=>(c(),e(`div`,{key:i,class:`p-3 sm:p-4 border rounded-lg space-y-2`},[r(`div`,Ae,[r(`div`,null,[r(`h3`,je,u(t(z)[i].name),1),r(`p`,Me,u(t(A)(n)),1)])]),r(`div`,Ne,[r(`p`,null,u(t(R)(`fleetView.attack`))+`: `+u(t(z)[i].attack),1),r(`p`,null,u(t(R)(`fleetView.shield`))+`: `+u(t(z)[i].shield),1),r(`p`,null,u(t(R)(`fleetView.armor`))+`: `+u(t(z)[i].armor),1),r(`p`,null,u(t(R)(`fleetView.speed`))+`: `+u(t(A)(t(z)[i].speed)),1),r(`p`,null,u(t(R)(`fleetView.cargo`))+`: `+u(t(A)(t(z)[i].cargoCapacity)),1)])]))),128))])]),_:1})]),_:1})])):v(``,!0),W.value===`send`?(c(),e(`div`,Pe,[l(t(N),null,{default:g(()=>[l(t(k),{class:`py-4`},{default:g(()=>[r(`div`,Fe,[r(`span`,Ie,u(t(R)(`fleetView.fleetMissionSlots`))+`:`,1),r(`span`,Le,u(t(L).player.fleetMissions.length)+` / `+u(_t.value),1)])]),_:1})]),_:1}),l(t(N),null,{default:g(()=>[l(t(D),null,{default:g(()=>[l(t(j),null,{default:g(()=>[_(u(t(R)(`fleetView.selectFleet`)),1)]),_:1}),l(t(x),null,{default:g(()=>[_(u(t(R)(`fleetView.selectFleetDescription`)),1)]),_:1})]),_:1}),l(t(k),null,{default:g(()=>[r(`div`,Re,[(c(!0),e(n,null,s(B.value.fleet,(n,i)=>(c(),e(`div`,{key:i,class:`space-y-2`},[l(t(M),{for:`ship-${i}`,class:`text-xs sm:text-sm`},{default:g(()=>[_(u(t(z)[i].name)+` (`+u(t(R)(`fleetView.available`))+`: `+u(n)+`) `,1)]),_:2},1032,[`for`]),r(`div`,ze,[l(t(E),{id:`ship-${i}`,modelValue:G.value[i],"onUpdate:modelValue":e=>G.value[i]=e,modelModifiers:{number:!0},type:`number`,min:`0`,max:n,placeholder:`0`,class:`text-sm`},null,8,[`id`,`modelValue`,`onUpdate:modelValue`,`max`]),l(t(T),{onClick:e=>G.value[i]=n,variant:`outline`,size:`sm`},{default:g(()=>[_(u(t(R)(`fleetView.all`)),1)]),_:1},8,[`onClick`])])]))),128))])]),_:1})]),_:1}),l(t(N),null,{default:g(()=>[l(t(D),null,{default:g(()=>[l(t(j),null,{default:g(()=>[_(u(t(R)(`fleetView.targetCoordinates`)),1)]),_:1})]),_:1}),l(t(k),null,{default:g(()=>[r(`div`,Be,[r(`div`,Ve,[l(t(M),{for:`galaxy`,class:`text-xs sm:text-sm`},{default:g(()=>[_(u(t(R)(`fleetView.galaxy`)),1)]),_:1}),l(t(E),{id:`galaxy`,modelValue:K.value.galaxy,"onUpdate:modelValue":a[3]||=e=>K.value.galaxy=e,modelModifiers:{number:!0},type:`number`,min:`1`,max:`9`,placeholder:`1`},null,8,[`modelValue`])]),r(`div`,He,[l(t(M),{for:`system`,class:`text-xs sm:text-sm`},{default:g(()=>[_(u(t(R)(`fleetView.system`)),1)]),_:1}),l(t(E),{id:`system`,modelValue:K.value.system,"onUpdate:modelValue":a[4]||=e=>K.value.system=e,modelModifiers:{number:!0},type:`number`,min:`1`,max:`10`,placeholder:`1`},null,8,[`modelValue`])]),r(`div`,Ue,[l(t(M),{for:`position`,class:`text-xs sm:text-sm`},{default:g(()=>[_(u(t(R)(`fleetView.position`)),1)]),_:1}),l(t(E),{id:`position`,modelValue:K.value.position,"onUpdate:modelValue":a[5]||=e=>K.value.position=e,modelModifiers:{number:!0},type:`number`,min:`1`,max:`10`,placeholder:`1`},null,8,[`modelValue`])])])]),_:1})]),_:1}),l(t(N),null,{default:g(()=>[l(t(D),null,{default:g(()=>[l(t(j),null,{default:g(()=>[_(u(t(R)(`fleetView.missionType`)),1)]),_:1})]),_:1}),l(t(k),null,{default:g(()=>[r(`div`,We,[(c(!0),e(n,null,s(Y.value,e=>(c(),d(t(T),{key:e.type,onClick:t=>q.value=e.type,variant:q.value===e.type?`default`:`outline`,class:`justify-start`},{default:g(()=>[(c(),d(re(e.icon),{class:`h-4 w-4 mr-2`})),_(` `+u(e.name),1)]),_:2},1032,[`onClick`,`variant`]))),128))])]),_:1})]),_:1}),q.value===t(S).Transport?(c(),d(t(N),{key:0},{default:g(()=>[l(t(D),null,{default:g(()=>[l(t(j),null,{default:g(()=>[_(u(t(R)(`fleetView.transportResources`)),1)]),_:1})]),_:1}),l(t(k),null,{default:g(()=>[r(`div`,Ge,[r(`div`,Ke,[l(t(M),{for:`cargo-metal`,class:`text-xs sm:text-sm flex items-center gap-2`},{default:g(()=>[l(P,{type:`metal`,size:`sm`}),_(` `+u(t(R)(`resources.metal`))+` (`+u(t(R)(`fleetView.available`))+`: `+u(t(A)(B.value.resources.metal))+`) `,1)]),_:1}),l(t(E),{id:`cargo-metal`,modelValue:J.value.metal,"onUpdate:modelValue":a[6]||=e=>J.value.metal=e,modelModifiers:{number:!0},type:`number`,min:`0`,max:B.value.resources.metal,placeholder:`0`},null,8,[`modelValue`,`max`])]),r(`div`,qe,[l(t(M),{for:`cargo-crystal`,class:`text-xs sm:text-sm flex items-center gap-2`},{default:g(()=>[l(P,{type:`crystal`,size:`sm`}),_(` `+u(t(R)(`resources.crystal`))+` (`+u(t(R)(`fleetView.available`))+`: `+u(t(A)(B.value.resources.crystal))+`) `,1)]),_:1}),l(t(E),{id:`cargo-crystal`,modelValue:J.value.crystal,"onUpdate:modelValue":a[7]||=e=>J.value.crystal=e,modelModifiers:{number:!0},type:`number`,min:`0`,max:B.value.resources.crystal,placeholder:`0`},null,8,[`modelValue`,`max`])]),r(`div`,Je,[l(t(M),{for:`cargo-deuterium`,class:`text-xs sm:text-sm flex items-center gap-2`},{default:g(()=>[l(P,{type:`deuterium`,size:`sm`}),_(` `+u(t(R)(`resources.deuterium`))+` (`+u(t(R)(`fleetView.available`))+`: `+u(t(A)(B.value.resources.deuterium))+`) `,1)]),_:1}),l(t(E),{id:`cargo-deuterium`,modelValue:J.value.deuterium,"onUpdate:modelValue":a[8]||=e=>J.value.deuterium=e,modelModifiers:{number:!0},type:`number`,min:`0`,max:B.value.resources.deuterium,placeholder:`0`},null,8,[`modelValue`,`max`])])]),r(`p`,Ye,u(t(R)(`fleetView.totalCargoCapacity`))+`: `+u(t(A)(X()))+` | `+u(t(R)(`fleetView.used`))+`: `+u(t(A)(Z())),1)]),_:1})]),_:1})):v(``,!0),l(t(N),null,{default:g(()=>[l(t(D),null,{default:g(()=>[l(t(j),null,{default:g(()=>[_(u(t(R)(`fleetView.missionInfo`)),1)]),_:1})]),_:1}),l(t(k),{class:`space-y-2`},{default:g(()=>[r(`div`,Xe,[r(`span`,Ze,u(t(R)(`fleetView.fuelConsumption`))+`:`,1),r(`span`,Qe,[l(P,{type:`deuterium`,size:`sm`}),r(`span`,{class:f(Q()>B.value.resources.deuterium?`text-red-600 dark:text-red-400 font-medium`:``)},u(t(A)(Q())),3),r(`span`,F,`/ `+u(t(A)(B.value.resources.deuterium)),1)])]),Object.values(G.value).some(e=>e>0)?(c(),e(`div`,$e,[r(`span`,et,u(t(R)(`fleetView.flightTime`))+`:`,1),r(`span`,null,u(t(O)(bt())),1)])):v(``,!0)]),_:1})]),_:1}),l(t(T),{onClick:St,disabled:!$(),class:`w-full`,size:`lg`},{default:g(()=>[_(u(t(R)(`fleetView.sendFleet`)),1)]),_:1},8,[`disabled`])])):v(``,!0),W.value===`missions`?(c(),e(`div`,tt,[t(L).player.fleetMissions.length===0?(c(),d(t(N),{key:0},{default:g(()=>[l(t(k),{class:`py-8 text-center text-muted-foreground`},{default:g(()=>[_(u(t(R)(`fleetView.noFlightMissions`)),1)]),_:1})]),_:1})):v(``,!0),(c(!0),e(n,null,s(t(L).player.fleetMissions,i=>(c(),d(t(N),{key:i.id},{default:g(()=>[l(t(D),null,{default:g(()=>[r(`div`,nt,[r(`div`,null,[l(t(j),{class:`text-base sm:text-lg`},{default:g(()=>[_(u(vt(i.missionType)),1)]),_:2},1024),l(t(x),{class:`text-xs sm:text-sm`},{default:g(()=>[_(u(yt(i.originPlanetId))+` â†’ [`+u(i.targetPosition.galaxy)+`:`+u(i.targetPosition.system)+`:`+u(i.targetPosition.position)+`] `,1)]),_:2},1024)]),l(t(w),{variant:i.status===`outbound`?`default`:`secondary`},{default:g(()=>[_(u(i.status===`outbound`?t(R)(`fleetView.outbound`):t(R)(`fleetView.returning`)),1)]),_:2},1032,[`variant`])])]),_:2},1024),l(t(k),{class:`space-y-3`},{default:g(()=>[r(`div`,null,[r(`p`,rt,u(t(R)(`fleetView.fleetComposition`))+`:`,1),r(`div`,it,[(c(!0),e(n,null,s(i.fleet,(e,n)=>(c(),d(t(w),{key:n,variant:`outline`},{default:g(()=>[_(u(t(z)[n].name)+`: `+u(e),1)]),_:2},1024))),128))])]),i.cargo.metal>0||i.cargo.crystal>0||i.cargo.deuterium>0||i.cargo.darkMatter>0?(c(),e(`div`,at,[r(`p`,ot,u(t(R)(`fleetView.carryingResources`))+`:`,1),r(`div`,st,[i.cargo.metal>0?(c(),e(`span`,ct,[l(P,{type:`metal`,size:`sm`}),_(` `+u(t(A)(i.cargo.metal)),1)])):v(``,!0),i.cargo.crystal>0?(c(),e(`span`,lt,[l(P,{type:`crystal`,size:`sm`}),_(` `+u(t(A)(i.cargo.crystal)),1)])):v(``,!0),i.cargo.deuterium>0?(c(),e(`span`,ut,[l(P,{type:`deuterium`,size:`sm`}),_(` `+u(t(A)(i.cargo.deuterium)),1)])):v(``,!0),i.cargo.darkMatter>0?(c(),e(`span`,dt,[l(P,{type:`darkMatter`,size:`sm`}),_(` `+u(t(A)(i.cargo.darkMatter)),1)])):v(``,!0)])])):v(``,!0),r(`div`,ft,[r(`div`,pt,[r(`span`,null,u(i.status===`outbound`?t(R)(`fleetView.arrivalTime`):t(R)(`fleetView.returnTime`))+`:`,1),r(`span`,null,u(t(O)(Tt(i))),1)]),l(t(xe),{"model-value":Et(i)},null,8,[`model-value`])]),r(`div`,mt,[i.status===`outbound`?(c(),d(t(T),{key:0,onClick:e=>wt(i.id),variant:`outline`,size:`sm`,class:`w-full`},{default:g(()=>[_(u(t(R)(`fleetView.recallFleet`)),1)]),_:1},8,[`onClick`])):v(``,!0)])]),_:2},1024)]),_:2},1024))),128))])):v(``,!0),l(Ce,{ref_key:`alertDialog`,ref:V},null,512)])):v(``,!0)}});export{I as default};